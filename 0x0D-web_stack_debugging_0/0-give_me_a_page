#!/usr/bin/env bash
# this script initializes the Apache server

container_id=$(docker run -d -p 8080:80 holbertonschool/265-0)

# Check if the container is running
if [ -n "$container_id" ]; then
    echo "Apache container started. Container ID: $container_id"

    # Enter the container
    docker exec -it "$container_id" /bin/bash -c '
        # Install Apache if not already installed
        if ! command -v apache2 &>/dev/null; then
            apt-get update
            apt-get install -y apache2
        fi

        # Create HTML file with "Hello Holberton"
        echo "Hello Holberton" > /var/www/html/index.html

        # Restart Apache to apply changes
        service apache2 restart

        # Check Apache service status using systemctl
        if systemctl is-active --quiet apache2; then
            echo "apache2 is running"
        else
            echo "apache2 is not running"
        fi
    '

    echo "Setup completed. Access the page using: curl 0:8080"
else
    echo "Failed to start Apache container."
fi
